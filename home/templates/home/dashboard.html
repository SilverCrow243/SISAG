{% extends "base.html" %}

{% block title %}Tableau de Bord - SISAG{% endblock %}

{% block content %}


    <main class="container mx-auto p-8">
        
        <div class="mb-8">
            <h2 class="text-3xl font-bold text-yellow-400 mb-6">Tableau de Bord</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-gray-900 p-6 rounded-lg border border-yellow-400">
                    <h3 class="text-lg font-semibold text-yellow-400">Ministères</h3>
                    <p class="text-4xl font-bold mt-2">{{ total_ministries }}</p>
                </div>
                <div class="bg-gray-900 p-6 rounded-lg border border-yellow-400">
                    <h3 class="text-lg font-semibold text-yellow-400">Projets Actifs</h3>
                    <p class="text-4xl font-bold mt-2">{{ in_progress_projects }}</p>
                </div>
                <div class="bg-gray-900 p-6 rounded-lg border border-yellow-400">
                    <h3 class="text-lg font-semibold text-yellow-400">Projets Complétés</h3>
                    <p class="text-4xl font-bold mt-2">{{ completed_projects }}</p>
                </div>
                <div class="bg-gray-900 p-6 rounded-lg border border-yellow-400">
                    <h3 class="text-lg font-semibold text-yellow-400">Total Projets</h3>
                    <p class="text-4xl font-bold mt-2">{{ total_projects }}</p>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <div>
                <h3 class="text-2xl font-bold text-yellow-400 mb-4">Projets Récents</h3>
                <div class="space-y-2">
                    {% if projects %}
                        {% for project in projects %}
                        <div class="bg-gray-900 p-4 rounded-lg border border-gray-700 hover:border-yellow-400 transition duration-300">
                            <h4 class="font-semibold"><a href="{% url 'project_detail' pk=project.pk %}" class="hover:text-yellow-400">{{ project.title }}</a></h4>
                            <p class="text-sm text-gray-400">{{ project.ministry.name }}</p>
                            <div class="mt-2 bg-gray-800 rounded-full h-2">
                                <div class="bg-yellow-400 h-2 rounded-full" style="width: {{ project.progress_percentage }}%"></div>
                            </div>
                            <p class="text-sm text-gray-300 mt-1">{{ project.progress_percentage }}% complété</p>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-gray-400">Aucun projet disponible.</p>
                    {% endif %}
                </div>
            </div>

            <div>
                <h3 class="text-2xl font-bold text-yellow-400 mb-4">Statistiques</h3>
                <div class="space-y-2">
                    
                    <div class="bg-gray-900 p-4 rounded-lg border border-gray-700">
                        <h4 class="font-semibold">Progression Moyenne</h4>
                        <p class="text-2xl font-bold text-yellow-400">{{ avg_progress }}%</p>
                        <p class="text-sm text-gray-400">Moyenne sur l'ensemble des projets</p>
                    </div>

                    <div class="bg-gray-900 p-4 rounded-lg border border-gray-700">
                        <h4 class="font-semibold">Projets en retard</h4>
                        <p class="text-2xl font-bold {% if late_projects > 0 %}text-red-500{% else %}text-green-400{% endif %}">{{ late_projects }}</p>
                        <p class="text-sm text-gray-400">Nécessitant une action immédiate</p>
                    </div>
                     <div class="bg-gray-900 p-4 rounded-lg border border-gray-700">
                        <h4 class="font-semibold">Statut des Projets</h4>
                        <p class="text-sm text-gray-300 mt-2">
                            <span class="text-yellow-400">En cours: {{ in_progress_projects }}</span> | 
                            <span class="text-green-400">Complétés: {{ completed_projects }}</span> | 
                            <span class="text-gray-400">Planifiés: {{ planning_projects }}</span>
                        </p>
                    </div>

                </div>
            </div>
        </div>

    </main>
{% endblock %}
